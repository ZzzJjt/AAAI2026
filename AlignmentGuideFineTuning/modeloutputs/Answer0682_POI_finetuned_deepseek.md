### Intent:
**Intent Summary:**  
Create a control narrative for an ammonium nitrate reactor, specifying setpoints, instrumentation, procedures, and safety interlocks to automate and document safe, efficient reactor operation.  

*(Focused on reactor control parameters, automation readiness, and safety compliance.)*

### Prompt:
**Control Narrative for Ammonium Nitrate Reactor**

Create a control narrative for a reactor producing ammonium nitrates including concrete setpoints and ranges.

**R-I-S-E:**

ğŸŸ¥ R (Role) â€“ Define Your Role

You are a process control engineer responsible for developing a clear, automation-ready control narrative for an ammonium nitrate reactor used in industrial chemical production.

â¸»

ğŸŸ© I (Input) â€“ Information Provided

The reactor operates by reacting ammonia and nitric acid in a controlled environment. Your control narrative must include:
	â€¢	Concrete setpoints and operational ranges for temperature, pressure, flow, and pH
	â€¢	A list of critical instrumentation and equipment (e.g., TICs, PICs, flow controllers, analyzers)
	â€¢	Normal startup, operation, and shutdown procedures
	â€¢	Safety interlocks and alarm triggers for deviations from normal conditions

â¸»

ğŸŸ§ S (Steps) â€“ Steps to Perform
	1.	Define the core control parameters:
	â€¢	Temperature: 175â€¯Â°C (range: 173â€“177â€¯Â°C)
	â€¢	Pressure: 4.8â€¯bar (range: 4.6â€“5.0â€¯bar)
	â€¢	Flow ratio: Ammonia:Acid = 1.01:1
	â€¢	pH: 6.2 (acceptable range: 5.8â€“6.5)
	2.	List required instrumentation:
	â€¢	TIC-101 (reactor temperature controller)
	â€¢	PIC-102 (reactor pressure controller)
	â€¢	FIC-103/FIC-104 (ammonia/nitric acid flow controllers)
	â€¢	AIC-105 (pH analyzer)
	â€¢	LSH-106 (high-level switch for overfill protection)
	3.	Describe operating procedures:
	â€¢	Startup: Valve checks, initialize jacket heating, ramp up flows
	â€¢	Normal Operation: Maintain setpoints with PID loops; monitor pH and adjust feed as needed
	â€¢	Shutdown: Stop feeds, vent pressure, cool reactor, close all valves
	4.	Define interlocks and alarms:
	â€¢	ESD if Temp > 185â€¯Â°C, Pressure > 5.2â€¯bar, or pH < 5.5
	â€¢	Trigger alarms and lockout if ammonia or acid feed deviates Â±10% from target ratio

â¸»

ğŸŸ¦ E (Expectation) â€“ Expected Outcome

Deliver a clear, structured, and technically sound control narrative that:
	â€¢	Can be used by automation teams to configure DCS/PLC systems
	â€¢	Supports safety, efficiency, and compliance in reactor operation
	â€¢	Provides the basis for interlock diagrams, HMI logic, and alarm design
	â€¢	Enhances operator understanding and engineering documentation

### Generated Code:
**Intent Summary:**  
Create a control narrative for an ammonium nitrate reactor, specifying setpoints, instrumentation, procedures, and safety interlocks to automate and document safe, efficient reactor operation.  

*(Focused on reactor control parameters, automation readiness, and safety compliance.)*
**Control Narrative for Ammonium Nitrate Reactor**

Create a control narrative for a reactor producing ammonium nitrates including concrete setpoints and ranges.

**R-I-S-E:**

ğŸŸ¥ R (Role) â€“ Define Your Role

You are a process control engineer responsible for developing a clear, automation-ready control narrative for an ammonium nitrate reactor used in industrial chemical production.

â¸»

ğŸŸ© I (Input) â€“ Information Provided

The reactor operates by reacting ammonia and nitric acid in a controlled environment. Your control narrative must include:
	â€¢	Concrete setpoints and operational ranges for temperature, pressure, flow, and pH
	â€¢	A list of critical instrumentation and equipment (e.g., TICs, PICs, flow controllers, analyzers)
	â€¢	Normal startup, operation, and shutdown procedures
	â€¢	Safety interlocks and alarm triggers for deviations from normal conditions

â¸»

ğŸŸ§ S (Steps) â€“ Steps to Perform
	1.	Define the core control parameters:
	â€¢	Temperature: 175â€¯Â°C (range: 173â€“177â€¯Â°C)
	â€¢	Pressure: 4.8â€¯bar (range: 4.6â€“5.0â€¯bar)
	â€¢	Flow ratio: Ammonia:Acid = 1.01:1
	â€¢	pH: 6.2 (acceptable range: 5.8â€“6.5)
	2.	List required instrumentation:
	â€¢	TIC-101 (reactor temperature controller)
	â€¢	PIC-102 (reactor pressure controller)
	â€¢	FIC-103/FIC-104 (ammonia/nitric acid flow controllers)
	â€¢	AIC-105 (pH analyzer)
	â€¢	LSH-106 (high-level switch for overfill protection)
	3.	Describe operating procedures:
	â€¢	Startup: Valve checks, initialize jacket heating, ramp up flows
	â€¢	Normal Operation: Maintain setpoints with PID loops; monitor pH and adjust feed as needed
	â€¢	Shutdown: Stop feeds, vent pressure, cool reactor, close all valves
	4.	Define interlocks and alarms:
	â€¢	ESD if Temp > 185â€¯Â°C, Pressure > 5.2â€¯bar, or pH < 5.5
	â€¢	Trigger alarms and lockout if ammonia or acid feed deviates Â±10% from target ratio

â¸»

ğŸŸ¦ E (Expectation) â€“ Expected Outcome

Deliver a clear, structured, and technically sound control narrative that:
	â€¢	Can be used by automation teams to configure DCS/PLC systems
	â€¢	Supports safety, efficiency, and compliance in reactor operation
	â€¢	Provides the basis for interlock diagrams, HMI logic, and alarm design
	â€¢	Enhances operator understanding and engineering documentation
#include <iostream>
#include <string>
#include <vector>
#include <map>
#include <algorithm>
#include <cmath>
#include <cstdlib>
#include <ctime>
#include <cassert>

using namespace std;

// 1. å®šä¹‰çŠ¶æ€æœº
class StateMachine {
public:
    enum class State {
        IDLE,
        START,
        RUNNING,
        STOP,
        ERROR
    };

    State state;
    int errorCode;
    string errorMessage;

    StateMachine() : state(State::IDLE), errorCode(0), errorMessage("") {}
};

// 2. å®šä¹‰çŠ¶æ€è½¬ç§»å‡½æ•°
void Transition(StateMachine &sm, State nextState) {
    switch (sm.state) {
        case State::IDLE:
            if (nextState == State::START) {
                sm.state = State::START;
                sm.errorCode = 0;
                sm.errorMessage = "";
            }
            break;
        case State::START:
            if (nextState == State::RUNNING) {
                sm.state = State::RUNNING;
                sm.errorCode = 0;
                sm.errorMessage = "";
            }
            break;
        case State::RUNNING:
            if (nextState == State::STOP) {
                sm.state = State::STOP;
                sm.errorCode = 0;
                sm.errorMessage = "";
            }
            break;
        case State::STOP:
            if (nextState == State::ERROR) {
                sm.state = State::ERROR;
                sm.errorCode = 1;
                sm.errorMessage = "Stop error";
            }
            break;
        case State::ERROR:
            if (nextState == State::IDLE) {
                sm.state = State::IDLE;
                sm.errorCode = 0;
                sm.errorMessage = "";
            }
            break;
        default:
            assert(false);
    }
}

// 3. å®šä¹‰çŠ¶æ€æœºæ“ä½œå‡½æ•°
void Execute(StateMachine &sm) {
    switch (sm.state) {
